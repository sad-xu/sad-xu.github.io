(window.webpackJsonp=window.webpackJsonp||[]).push([[41],{243:function(t,s,a){"use strict";a.r(s);var n=a(0),p=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"深度解析异步串行的4种实现及区别"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#深度解析异步串行的4种实现及区别"}},[t._v("#")]),t._v(" 深度解析异步串行的4种实现及区别")]),t._v(" "),a("p",[t._v("事情起源于去年的某一天")]),t._v(" "),a("p",[t._v("需要做一个批量上传的功能，而接口只允许上传单个，一下子调用多个接口服务器又撑不住\n，所以只能用串行的方案，一次只调一个接口，拿到返回值后再调下一个")]),t._v(" "),a("p",[t._v("于是问题就抽象成了：多个异步方法如何串行调用")]),t._v(" "),a("hr"),t._v(" "),a("h2",{attrs:{id:"你可知茴字有几种写法？"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#你可知茴字有几种写法？"}},[t._v("#")]),t._v(" 你可知茴字有几种写法？")]),t._v(" "),a("p",[t._v("先模拟一个请求")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("request")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("param")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Promise")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("resolve"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" reject")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setTimeout")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token template-string"}},[a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("request: ")]),a("span",{pre:!0,attrs:{class:"token interpolation"}},[a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("param"),a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("resolve")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("param"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("待传参数数组，数组长度即为待调的接口次数")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" params "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'a'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'b'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'c'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])]),a("ul",[a("li",[t._v("方法一："),a("code",[t._v("async/await")])])]),t._v(" "),a("p",[a("code",[t._v("async/await")]),t._v("是最先想到的方法")]),t._v(" "),a("p",[t._v("这也是个人认为最简单，最简洁，最优雅的一种写法")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" v "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("of")]),t._v(" params"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("request")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("v"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("ul",[a("li",[t._v("方法二: 循环")])]),t._v(" "),a("p",[t._v("for循环配合promise，只比方法一多了一个变量")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" p "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Promise"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("resolve")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" v "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("of")]),t._v(" params"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  p "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" p"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("request")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("ul",[a("li",[t._v("方法三：递归")])]),t._v(" "),a("p",[t._v("既然for可以，那递归也就可以")]),t._v(" "),a("p",[t._v("但递归和前两者相比就显得有点麻烦了")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("loop")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("params")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("request")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("params"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("splice")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("params"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("loop")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("params"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("loop")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("params"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("ul",[a("li",[t._v("方法四："),a("code",[t._v("reduce")])])]),t._v(" "),a("p",[t._v("没想到吧.jpg")]),t._v(" "),a("p",[a("code",[t._v("reduce")]),t._v("配合"),a("code",[t._v("promise")]),t._v("竟然会有这种效果")]),t._v(" "),a("p",[t._v("其实仔细看它其实和方法二有点类似")]),t._v(" "),a("p",[t._v("就是把方法二里的变量变成了"),a("code",[t._v("acc")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("params"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("reduce")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("acc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" param")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" acc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("request")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("param"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Promise"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("resolve")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("p",[t._v("但是")]),t._v(" "),a("p",[t._v("这四种方法仅仅是只有以上这些表面上的异同吗")]),t._v(" "),a("p",[t._v("真正运行起来怎么样呢")]),t._v(" "),a("p",[t._v("我不知道")]),t._v(" "),a("p",[t._v("但浏览器可以让我知道")]),t._v(" "),a("hr"),t._v(" "),a("h2",{attrs:{id:"不多不多！多乎哉？不多也"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#不多不多！多乎哉？不多也"}},[t._v("#")]),t._v(" 不多不多！多乎哉？不多也")]),t._v(" "),a("p",[t._v("新建一个test.html，加上上文的模拟请求函数")]),t._v(" "),a("p",[t._v("把定时器的时间缩短为100ms")]),t._v(" "),a("p",[t._v("函数运行过程尽量短一点，避免垃圾回收影响结果")]),t._v(" "),a("p",[t._v("加上模拟请求参数，5个")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" params "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Array"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("from")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("length"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("map")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("item"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" index")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" index"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("p",[t._v("加一个按钮，绑定点击事件，点击时，调用上文四个方法的其中一个")]),t._v(" "),a("p",[t._v("打开控制台-Performance，统一记录十秒，第三秒点击按钮")]),t._v(" "),a("p",[t._v("把上面四种方法分别测一遍后，得到了四份结果")]),t._v(" "),a("p",[a("strong",[t._v("async/await")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2019/7/25/16c298a2722f526f?w=1365&h=398&f=png&s=24033",alt:"async/await"}})]),t._v(" "),a("p",[a("strong",[t._v("循环")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2019/7/25/16c298d4b7c895ca?w=1365&h=399&f=png&s=27645",alt:"循环"}})]),t._v(" "),a("p",[a("strong",[t._v("递归")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2019/7/25/16c298e89cb660c8?w=1365&h=394&f=png&s=24099",alt:"递归"}})]),t._v(" "),a("p",[a("strong",[t._v("reduce")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2019/7/25/16c298f13c65f393?w=1364&h=388&f=png&s=23506",alt:"reduce"}})]),t._v(" "),a("p",[t._v("中间Main里第一个较粗的黄色柱子是点击事件")]),t._v(" "),a("p",[t._v("后面5个细柱子是执行的5次函数")]),t._v(" "),a("p",[t._v("下面蓝色线是内存占用情况，每次上涨都对应了函数的执行")]),t._v(" "),a("p",[t._v("这四张图里有一张和其他图都不一样")]),t._v(" "),a("p",[t._v("你发现了吗")]),t._v(" "),a("hr"),t._v(" "),a("h3",{attrs:{id:"一个区别"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#一个区别"}},[t._v("#")]),t._v(" 一个区别")]),t._v(" "),a("p",[t._v("没错，就是第二张：循环！")]),t._v(" "),a("p",[t._v("在点击的那个时刻，它的内存就上涨了")]),t._v(" "),a("p",[t._v("而其他图的内存都是在第一个定时器结束时，才开始上涨的")]),t._v(" "),a("p",[t._v("为什么偏偏是循环最特殊呢？")]),t._v(" "),a("p",[t._v("可以把整个执行过程看做一条promise链")]),t._v(" "),a("p",[t._v("promise.then().then().then()....")]),t._v(" "),a("p",[t._v("只有循环是在一开始就把这条链构建出来了")]),t._v(" "),a("p",[t._v("而其他方法都是只有在前一个then执行结束后才会再添一个then")]),t._v(" "),a("p",[t._v("即循环可以看做是首次就完全加载")]),t._v(" "),a("p",[t._v("其他三个方法可以看成是按需加载")]),t._v(" "),a("h3",{attrs:{id:"另一个区别"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#另一个区别"}},[t._v("#")]),t._v(" 另一个区别")]),t._v(" "),a("p",[t._v("放大Main里点击事件的区域")]),t._v(" "),a("p",[a("strong",[t._v("async/await")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2019/7/25/16c2992ab7da0c18?w=1354&h=157&f=png&s=8401",alt:"async/await"}})]),t._v(" "),a("p",[a("strong",[t._v("循环")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2019/7/25/16c2992dee737631?w=1363&h=165&f=png&s=9333",alt:"循环"}})]),t._v(" "),a("p",[a("strong",[t._v("递归")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2019/7/25/16c299306377cd4e?w=1356&h=161&f=png&s=7904",alt:"递归"}})]),t._v(" "),a("p",[a("strong",[t._v("reduce")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2019/7/25/16c299323efe40bf?w=1351&h=170&f=png&s=10836",alt:"reduce"}})]),t._v(" "),a("p",[t._v("根据点击时request的执行阶段可以分为两类")]),t._v(" "),a("p",[a("code",[t._v("循环")]),t._v("、"),a("code",[t._v("reduce")]),t._v("：在Microtasks即微任务下")]),t._v(" "),a("p",[a("code",[t._v("async/await")]),t._v("、"),a("code",[t._v("递归")]),t._v("：在点击事件回调即正常的主任务下")]),t._v(" "),a("p",[t._v("为什么会出现这种不同呢？还记得上文说的"),a("code",[t._v("reduce")]),t._v("和"),a("code",[t._v("循环")]),t._v("有点类似吗，再结合之前"),a("code",[t._v("promise")]),t._v("链的说法，不难看出")]),t._v(" "),a("p",[t._v("他们的起点是"),a("code",[t._v("Promise.resolve()")]),t._v("，第一个"),a("code",[t._v("request")]),t._v("是在"),a("code",[t._v("then")]),t._v("里的调用的")]),t._v(" "),a("p",[t._v("而另外两个的起点是"),a("code",[t._v("request()")]),t._v("，第一个"),a("code",[t._v("request")]),t._v("是作为普通函数调用的")]),t._v(" "),a("p",[t._v("异步中的方法都会在Microtasks中执行，Microtasks又是紧跟在主任务后的，所以才会出现这种执行队列的不同")]),t._v(" "),a("p",[t._v("这就又牵扯到浏览器的事件队列机制了，记得掘金有文章专门分析这个机制，这里就不专门说了")]),t._v(" "),a("h2",{attrs:{id:"总结"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#总结"}},[t._v("#")]),t._v(" 总结")]),t._v(" "),a("p",[t._v("异步串行平时几乎不会用到，但里面要挖还是可以挖出很多东西来的")]),t._v(" "),a("p",[t._v("这四种方法首推async/await")]),t._v(" "),a("p",[t._v("循环的话，如果有很长的then链要小心一点，一下子构造出太长的链可能不大好")]),t._v(" "),a("p",[t._v("递归主要是写法太烦，会多出一个函数")]),t._v(" "),a("p",[t._v("reduce可读性会欠缺一点，炫技的话还是不错的")]),t._v(" "),a("hr"),t._v(" "),a("p",[t._v("以上结论均是本人在测试后得出的，不保证完全正确")]),t._v(" "),a("p",[t._v("如有错误，请大佬们指正，给大佬们磕头了，砰！砰！！砰！！！")]),t._v(" "),a("p",[t._v("个人公众号[沉默池塘]，随缘关注，随缘更新")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2019/7/25/16c299f469031fe9?w=258&h=258&f=jpeg&s=27683",alt:"沉默池塘"}})])])}),[],!1,null,null,null);s.default=p.exports}}]);